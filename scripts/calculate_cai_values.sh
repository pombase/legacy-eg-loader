#!/bin/bash --

MY_DIR=`dirname $0`
source $MY_DIR/../SetEnv

ge100k='SPAC23A1.10,SPBC19C2.07,SPBC32F12.11,SPCC13B11.01,SPBC1815.01,SPBC26H8.01,SPBC14F5.04c,SPBP22H7.08,SPBC1685.09,SPAC4H3.10c,SPAC1F8.07c,SPCC576.03c,SPAC26F1.06,SPAC1F7.13c,SPBC14F5.05c,SPCC1739.13,SPCC1223.02,SPBC32H8.12c,SPCC962.04,SPAC3H5.12c,SPBC56F2.12,SPAC9.09,SPAC26H5.10c,SPAC6B12.15,SPAC926.04c,SPBC8D2.18c,SPBC660.16,SPCC330.06c,SPCC16C4.13c,SPAC821.10c,SPAPJ698.02c,SPBC28F2.03,SPCC417.08,SPAC3A12.10,SPAC31G5.03,SPAC25B8.12c,SPBC215.05,SPBC1685.10,SPAC664.05,SPBC1709.05,SPBC428.11,SPBC21B10.08c,SPBC16H5.02,SPCC1183.08c,SPBC530.07c,SPAC3G9.03,SPBC29A3.04,SPCC18.14c,SPCC576.08c,SPBC16G5.14c,SPAC24C9.12c,SPBC19F8.08,SPBC2G5.05,SPAC4F10.14c,SPAC3C7.14c,SPAC23H4.06,SPAC23A1.08c,SPBC16D10.11c,SPAC1006.07,SPCP31B10.07,SPAPB8E5.06c,SPCC1020.06c,SPAC18G6.14c,SPAC3H5.05c,SPBP8B7.06,SPAC6G10.11c,SPBC1289.03c,SPAC1071.10c,SPAC6F6.07c,SPAC1782.11,SPAC1071.08,SPBC27.08c,SPAC10F6.06,SPAC9G1.03c,SPBC25H2.05,SPCC622.12c,SPAC23C11.05,SPAC9E9.09c,SPAC8E11.02c,SPAC4F8.07c,SPCC74.05,SPAC29A4.02c,SPAC22A12.15c,SPBC776.11,SPBC18E5.06,SPCC613.05c,SPCC1450.04,SPBC18H10.12c,SPAC29B12.04,SPBC21C3.08c,SPCC364.07,SPAC11E3.15,SPCC1322.04,SPCC191.02c,SPAC5D6.01,SPBC106.18,SPAC24H6.07,SPBC17G9.10,SPAC2C4.16c,SPAC4G9.03,SPAP8A3.07c,SPAC4F8.14c,SPBC2G2.04c,SPBC24C6.04,SPCC777.09c,SPAC4F10.20,SPBC3B8.03,SPAC23H4.10c,SPBC215.09c,SPCC622.09,SPAC607.03c,SPBC3F6.03,SPCC576.09'

cd ..
mkdir -p data/tmp

cp data/FTP/cdna_nointrons_noutrs.fa.gz data/tmp
gunzip data/tmp/cdna_nointrons_noutrs.fa.gz
sed -i -e 's/|.*//g' data/tmp/cdna_nointrons_noutrs.fa

perl misc_scripts/get_cDNA.pl -eg_host $DBHOST -eg_port $DBPORT -eg_user $DBUSER -eg_pass $DBPASS -eg_species $SPECIES -eg_dbname $DBCORENAME -genes $ge100k

# Insert the analysis_id required.
# insert into attrib_type (code, name, description) VALUES ('CodonAdaptIndex', 'Codon Adaptation Index', 'Pepstats attributes');
python misc_scripts/calculate_cai_ratios.py --host $DBPOMBEHOST --port $DBPOMBEPORT --user $DBPOMBEUSER --pswd $DBPOMBEPASS --db $DBCORENAME --loaddb 1
